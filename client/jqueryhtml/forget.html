<!DOCTYPE html>
<html>

<head>
    <title>Andhra Pradesh State FiberNet Ltd</title>
    <!-- <base href="/"> -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
        }

        .container {
            width: 100%;
        }

        form {
            padding: 8%;
            /* background: #2c3e50; */
            color: #000000;
            -moz-border-radius: 4px;
            -webkit-border-radius: 4px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 400;
        }

        form label,
        form input,
        form button {
            border: 0;
            margin-bottom: 3px;
            display: block;
            width: 100%;
            font-weight: 500;
            padding: 5px 0px;
        }

        form input {
            height: 50px;
            line-height: 25px;
            background: #fff;
            color: #000;
            border: 1px solid gainsboro;
            padding: 0 6px;
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            border-radius: 6px;
        }

        form button {
            width: 100%;
            margin: 16px auto;
            display: block;
            background-color: #03A9F4;
            color: white;
            text-transform: uppercase;
            padding: 10px 0px;
            border-radius: 3px;
            cursor: pointer;
        }

        form button:hover,
        button:active {
            box-shadow: 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12);
        }

        form .error {
            color: #ff0000;
        }

        .sidenav {
            height: 100%;
            width: 20%;
            position: fixed;
            z-index: 1;
            top: 0;
            right: 0;
            background-color: #fff;
            overflow-x: hidden;
            box-shadow: -2px -2px 20px #bbb7b7;
            background: linear-gradient(45deg, #ffffff 87%, #f16136 87%) !important;
        }

        .sidenav a {
            padding: 6px 8px 6px 16px;
            text-decoration: none;
            font-size: 25px;
            color: #818181;
            display: block;
        }

        .sidenav a:hover {
            color: #f1f1f1;
        }

        .main {
            font-size: 28px;
            width: 80%;
            height: 100%;
            position: fixed;
            background: linear-gradient(-135deg, #ffffff 75%, #f16136 70%);
            margin-left: -10px;
        }

        .main .mdlPrt {
            margin-top: -100px;
            position: absolute;
            text-align: center;
            top: 45%;
            width: 100%;
        }

        .hdr {
            margin-top: 30px;
            text-align: center;
            font-size: 17px;
            font-weight: 500;
            text-shadow: 3px 2px 2px rgba(0, 0, 0, 0.18);
            color: rgba(0, 0, 0, 0.67);
        }

        .main h1 {
            margin: 0px;
            text-align: center;
            font-size: 42px !important;
            color: #2a5584;
            font-weight: 500;
        }

        .logoImg {
            text-align: center;
            margin: auto;
            padding-top: 25%;
        }

        /* .logoImg img {
            width: 60%;
        } */

        .footer {
            position: fixed;
            left: 0;
            bottom: 0;
            width: 100%;
            color: white;
            text-align: center;
        }

        .header {
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            color: white;
            text-align: center;
        }

        .header p {
            width: 77%;
            text-align: right;
        }

        .footer p {
            margin-top: -150px;
            font-weight: 600;
            color: #1c1c80;
            font-size: 18px;
        }

        .footer p b {
            margin-top: -150px;
            font-weight: 400;
        }


        .footer_mbl {
            display: none;
        }

        /* For 1024 Resolution */
        @media only screen and (min-device-width : 768px) and (max-device-width : 1024px) {

            /* STYLES GO HERE */
            .footer_mbl {
                display: none;
            }
        }

        @media only screen and (min-width: 1370px) and (max-width: 1605px) {
            .footer_mbl {
                display: none;
            }
        }



        /* For 640 Resolution */
        @media only screen and (min-device-width : 360px) and (max-device-width : 640px) {
            .main {
                display: none
            }

            .sidenav {
                width: 100%
            }

            .logoImg {
                padding-top: 5%;
            }

            form label,
            form input,
            form button {
                font-size: 24px;
            }

            form input {
                height: 65px;
                font-size: 20px;
            }

            .hdr {
                font-size: 35px;
            }

            .footer_mbl {
                position: fixed;
                left: 0;
                bottom: 0;
                width: 100%;
                color: white;
                text-align: center;
                display: block !important;
            }

            .footer_mbl p {
                margin-top: -150px;
                font-weight: 600;
                color: #1c1c80;
                font-size: 30px;
            }

            .footer_mbl p b {
                margin-top: -150px;
                font-weight: 400;
            }
        }

        /* For 480 Resolution */
        @media only screen and (min-device-width : 320px) and (max-device-width : 480px) {
            .main {
                display: none
            }

            .sidenav {
                width: 100%
            }

            .logoImg {
                padding-top: 5%;
            }

            form label,
            form input,
            form button {
                font-size: 24px;
            }

            form input {
                height: 65px;
                font-size: 20px;
            }

            .hdr {
                font-size: 35px;
            }

            .footer_mbl {
                position: fixed;
                left: 0;
                bottom: 0;
                width: 100%;
                color: white;
                text-align: center;
                display: block !important;
            }

            .footer_mbl p {
                margin-top: -150px;
                font-weight: 600;
                color: #1c1c80;
                font-size: 30px;
            }

            .footer_mbl p b {
                margin-top: -150px;
                font-weight: 400;
            }
        }

        .imgapfsl {
            max-width: 100%;
            height: auto;
            vertical-align: top;
            border: none;
            width: 35%;
            margin-left: auto;
            margin-right: auto;
            display: block;
        }

        .imgdt {
            max-width: 100%;
            height: auto;
            vertical-align: top;
            border: none;
            width: 50%;
            margin-left: auto;
            margin-right: auto;
            display: block;
        }

        .checkbox {
            display: inline-block;
            height: 16px;
            line-height: 0;
            margin: auto;
            margin-right: 8px;
            order: 0;
            position: relative;
            vertical-align: middle;
            white-space: nowrap;
            width: 16px;
            flex-shrink: 0;
        }

        .chcktxt {
            line-height: 24px;
            font-family: Muli, Helvetica Neue, Arial, sans-serif;
            font-size: 14px;
        }

        .col-1 {
            width: 8.33%;
        }

        .col-2 {
            width: 16.66%;
        }

        .col-3 {
            width: 25%;
        }

        .col-4 {
            width: 33.33%;
        }

        .col-5 {
            width: 41.66%;
        }

        .col-6 {
            width: 50%;
            margin: 0px;
            float: left;
        }

        .col-7 {
            width: 58.33%;
        }

        .col-8 {
            width: 66.66%;
        }

        .col-9 {
            width: 75%;
        }

        .col-10 {
            width: 83.33%;
        }

        .col-11 {
            width: 91.66%;
        }

        .col-12 {
            width: 100%;
        }

        .froget {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #40548f;
        }

        ::placeholder {
            /* Chrome, Firefox, Opera, Safari 10.1+ */
            color: #686868;
            line-height: 24px;
            font-family: Muli, Helvetica Neue, Arial, sans-serif;
            font-size: 14px;
        }

        .go {
            text-align: center !important;
            font-size: 13px;
            color: black;
            font-weight: 500;
        }
    </style>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
</head>

<body>


    <div class="container">
        <div class="sidenav">
            <div class="logoImg">
                <img src="/client/src/assets/images/APSFL.png" class="imgdt">

            </div>
            <form id="frogt_form" action="">
                <h2 class="hdr">RECOVER YOUR PASSWORD</h2>

                <input type="text" name="username" id="mrcht_usr_nm" placeholder="Username" required />

                <input type="text" name="mobile_number" id="phno" placeholder="phone Number" required
                    style="margin-top:8%" maxlength="10" /><span id="errmsg"
                    style="color:red;float: right;margin: 2%;"></span>
                <p id="err_msg"></p>
                <button type="submit">SEND OTP</button>
                <a class="link" href="/" style="text-align: center !important;font-size: 13px;color: black;font-weight: 500;">Go back to login</a>
            </form>
            <form id="Otp_form" action="">
                <h2 class="hdr">ENTER OTP</h2>

                <input type="text" name="otp" id="otp" placeholder="OTP" required />
                <p id="err_otp_msg"></p>
                <button type="submit">Submit OTP</button>
                <a class="link" href="/" style="text-align: center !important;font-size: 13px;color: black;font-weight: 500;">Go back to login</a>

            </form>
            <form id="Passwrd_cnfrm_form" action="">
                <h2 class="hdr">SET YOUR PASSWORD</h2>

                <label for="password">New Password</label>
                <input type="password" name="password" id="password"
                    placeholder="Ex:&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;" required />

                <label for="password">Password (Confirm)</label>
                <input type="password" name="Confirm_password" id="cnfrmpwd"
                    placeholder="Ex:&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;" required />
                <p id="err_pwd_cnf_msg"></p>

                <button type="submit">SAVE</button>
                <a class="link" href="/" style="text-align: center !important;font-size: 13px;color: black;font-weight: 500;">Go back to login</a>

            </form>
            <div class="footer_mbl">

                <p><img src="/client/src/assets/images/logos/glits_D.png"
                        style="width:60px;height:60px;vertical-align: middle;">&nbsp;&nbsp;<b>Powered
                        by&nbsp;&nbsp;</b>Andhra Pradesh State FiberNet Ltd</p>
            </div>
        </div>

        <div class="main">
            <div class="header">

                <p><img src="/client/src/assets/images/cm2.png"
                        style="vertical-align: middle;width: 100px;margin-top: 10px;">
                </p>
            </div>
            <div class="mdlPrt">
                <h1>Welcome to</h1>
                <img src="/client/src/assets/images/APSFL.png" class="imgapfsl">
            </div>

            <div class="footer">

                <p>
                    <img src="/client/src/assets/images/logos/glits_D.png"
                        style="width:60px;height:60px;vertical-align: middle;">
                    &nbsp;&nbsp;<b>Powered
                        by&nbsp;&nbsp;</b>Andhra Pradesh State FiberNet Ltd</p>
            </div>
        </div>

    </div>


</body>

</html>


<script>
    $(document).ready(function () {
        $("#phno").keypress(function (e) {
            // Allow only backspace and delete
            if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                //display error message
                $("#errmsg").html("Digits Only").show().fadeOut("slow");
                return false;
            }
        });
    });
    $(document).ready(function () {
        $("#Otp_form").hide();
        $("#Passwrd_cnfrm_form").hide();
        var resOtp = '';
        var mrcht_usr_id;
        $('#frogt_form').submit(function (e) {
            let url = `http://localhost:4901/apiv1/forgot-password/send_otp`;

            e.preventDefault();
            var mrcht_usr_nm = $('#mrcht_usr_nm').val();
            var phno = $('#phno').val();
            let data = {
                phno: phno,
                mrcht_usr_nm: mrcht_usr_nm,
            }
            $.ajax({
                type: 'POST',
                url: url,
                data: data,
                success: function (response, status, xhr) {
                    console.log(response)
                    console.log(status)
                    if (response.status == 200) {
                        if (response.data.errorCode == "notvadusrDtls") {
                            $("#err_msg").html("Incorrect username or phone number. Please try again.").show();
                        }
                        else if (response.data.code) {
                            $("#Otp_form").show();
                            $("#frogt_form").hide();
                            resOtp = response.data.code;
                            mrcht_usr_id = response.data.mrcht_usr_id;

                        }
                    }
                },
                error: function (request, textStatus, errorThrown) {

                }
            });
        })
        $('#Otp_form').submit(function (e) {
            e.preventDefault();
            var Rotp = $('#otp').val();
            console.log(Rotp, resOtp)
            if (Rotp == resOtp) {
                $("#Otp_form").hide();
                $("#frogt_form").hide();
                $("#Passwrd_cnfrm_form").show();
            }
            else {
                console.log("nbjnjkndjghfg")
                $("#err_otp_msg").html("Enter Valid OTP.").show();

            }

        })
        $('#Passwrd_cnfrm_form').submit(function (e) {
            let url1 = `http://localhost:4901/apiv1/change_password`;

            e.preventDefault();
            var passwrd = $('#password').val();
            var confirm = $('#cnfrmpwd').val();
            let data = {
                mrcht_usr_id: mrcht_usr_id,
                nw_pswrd: passwrd
            }
            if (passwrd == confirm) {
                $.ajax({
                    type: 'POST',
                    url: url1,
                    data: data,
                    success: function (response, status, xhr) {
                        console.log(response)
                        console.log(status)
                        if (response.status == 200) {
                            if (!response.data) {
                                $("#err_pwd_cnf_msg").html("Try again with a password that you haven't used before.").show();
                            }
                            else {
                                window.location.href = "/";
                            }
                        }
                    },
                    error: function (request, textStatus, errorThrown) {

                    }
                });
            }
            else {
                $("#err_pwd_cnf_msg").html("Password doesn't match.").show()
            }
        })
    })
</script>