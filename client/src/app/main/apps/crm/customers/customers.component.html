<div class="page-layout blank usrEmplye pageBackground cusAcntCmpnt">
  <pg-top-header [headerDtls]="getHeaderDtls()"></pg-top-header>
  <div fxLayout="row">
    <div fxFlex="80"></div>
    <div fxFlex="16">

      <!-- <button class="addBtn-color mb-8 mt-8 mat-raised-button mat-primary" color="primary" mat-raised-button=""
        style="float:right" (click)="opensideBar('addFormPanel',null)">
        <span class="mat-button-wrapper">
          <mat-icon class="addfld-icon-color mat-icon material-icons mat-icon-no-color" role="img" aria-hidden="true">
            person</mat-icon>
          <span class="pt-2">&nbsp;Add New Customer</span>
        </span>
      </button> -->

      <button mat-raised-button color="primary" class="m-16 mr-40 addBtn addBtn-color" style="float:right"
        *ngIf="showBckBtn" (click)="bckBtn()">

        <span class="pt-2">Back</span>
      </button>
    </div>
  </div>

  <div *ngIf="showTble" class="p-40 pt-0">
    <div class="ds-card grid" *ngIf="(permissions.slct_in==1)?true:false">
      <dx-data-grid id="gridContainer" [dataSource]="rowData" [remoteOperations]="false" [allowColumnReordering]="true" [allowColumnResizing]="true"
        [rowAlternationEnabled]="true" [showColumnLines]="true" [showRowLines]="true" [showBorders]="true"
        (onToolbarPreparing)="onToolbarPreparing($event)" style="width:100%">
        <!-- <dxo-selection mode="multiple"></dxo-selection> -->
        <dxo-paging [pageSize]="10"></dxo-paging>
        <dxo-pager [visible]="true" [showPageSizeSelector]="true" [allowedPageSizes]="[10, 25, 50, 100]" [showInfo]="true"></dxo-pager>
        <dxo-search-panel [visible]="true" [highlightCaseSensitive]="true"></dxo-search-panel>
        <dxo-filter-panel [visible]="true"></dxo-filter-panel>
        <dxo-group-panel [visible]="true"></dxo-group-panel>
        <dxo-grouping [autoExpandAll]="false"></dxo-grouping>
        <dxo-column-chooser [enabled]="true" mode="select">
          <!-- or "select" -->
        </dxo-column-chooser>
        <dxo-export [enabled]="(permissions.exprt_in==1)?true:false" [allowExportSelectedData]="true" fileName="Customers List"></dxo-export>
        <dxo-filter-row [visible]="true"></dxo-filter-row>
        <dxi-column [allowResizing]="true" *ngFor="let f of columnDefs" [visible]="!f.hide" [dataField]="f.field" [caption]="f.headerName"
          alignment="f.cellStyle.text-align" [width]="f.width"></dxi-column>
        <dxi-column [allowResizing]="true" [showInColumnChooser]="false" [visible]="(permissions.updt_in==1)?true:false" type="buttons"
          [width]="100" caption="Edit" cellTemplate="editTemplate">
          <div *dxTemplate="let data of 'editTemplate'">
            <div class="cursor-pointer" (click)="onCellClick(data)">
              Edit
            </div>
          </div>
        </dxi-column>
        <dxi-column [allowResizing]="true" [showInColumnChooser]="false" [visible]="(permissions.dlte_in==1)?true:false" type="buttons"
          [width]="100" caption="Delete" cellTemplate="delTemplate">
          <div *dxTemplate="let data of 'delTemplate'">
            <div class="cursor-pointer" (click)="onCellClick(data)">
              Delete
            </div>
          </div>
        </dxi-column>
      </dx-data-grid>

    </div>
    <!-- <ag-grid-angular #agGrid style="width: 100%; height: 530px;" class="ag-theme-balham p-12" [pagination]="pagination"
      [paginationPageSize]="paginationPageSize" [rowData]="rowData" [columnDefs]="columnDefs" [enableFilter]="true"
      [getRowHeight]="getRowHeight" [rowSelection]="rowSelection" [loadingCellRenderer]="loadingCellRenderer"
      [defaultColDef]="defaultColDef" [localeTextFunc]="localeTextFunc"
      [overlayLoadingTemplate]="overlayLoadingTemplate" [loadingCellRendererParams]="loadingCellRendererParams"
      [suppressHorizontalScroll]="false" [floatingFilter]="true" (cellClicked)="onCellClick($event)">
    </ag-grid-angular> -->
  </div>

  <ds-sidebar class="form-panel myPrfleSidebar ds-form-sidebar" name="addFormPanel" position="right"
    [invisibleOverlay]="false">
    <ng-container>
      <div class="fuse-card usrcrteCrd" id="scrollTop">
        <!-- <div class="card"> -->
        <div class="card-header crdHdng">Customers
          <mat-icon matTooltip="close" (click)="closeSideBar()" class="closeSidebar" style="float:right">cancel
          </mat-icon>
        </div>

        <form fxLayout="column" [formGroup]="firstFormGroup" class="m-24">
          <ng-template matStepLabel>Add Customer</ng-template>
          <mat-divider></mat-divider>
          <div class="font-size-17 font-weight-500 pt-8 mb-0 pl-8 pb-8 red-800-fg">Customer Information</div>
          <mat-divider style="margin-bottom: 13px;"></mat-divider>

          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter First Name*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>First Name</mat-label> -->
                <input matInput formControlName="firstName" required>
                <mat-error> Name is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Middle Name</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Middle Name</mat-label> -->
                <input matInput formControlName="middleName">
                <!-- <mat-error>Last Name is required!</mat-error> -->
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Last Name*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Last Name</mat-label> -->
                <input matInput formControlName="lastName" required>
                <mat-error>Last Name is required!</mat-error>
              </mat-form-field>
            </div>

          </div>

          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Select Gender Name*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Gender</mat-label> -->
                <mat-select formControlName="gender" required>
                  <mat-option *ngFor="let g of gndrLst" [value]="g.gndr_id">
                    {{g.gndr_nm}}
                  </mat-option>
                </mat-select>
                <mat-error>Gender is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Select Date Of Birth*</div>
              <mat-form-field appearance="outline">
                <input matInput [matDatepicker]="picker1" formControlName="dateofbirth" required>
                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                <mat-datepicker #picker1></mat-datepicker>
                <mat-error>Date Of Birth is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Father/Husband Name</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Father/Husband Name</mat-label> -->
                <input matInput formControlName="father_husbandname">
                <!-- <mat-error>Last Name is required!</mat-error> -->
              </mat-form-field>
            </div>


          </div>
          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Aadhaar No*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Aadhaar No</mat-label> -->
                <input matInput formControlName="adharno" required>
                <mat-error>Aadhaar No is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter PAN No</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Pan Card No</mat-label> -->
                <input matInput formControlName="pan_card_no">
                <!-- <mat-error>Last Name is required!</mat-error> -->
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Email</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Email</mat-label> -->
                <input matInput formControlName="email">
                <!-- <mat-error>Last Name is required!</mat-error> -->
              </mat-form-field>
            </div>

          </div>


          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Mobile Number*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Mobile Number</mat-label> -->
                <input type="number" matInput formControlName="mobileNumber" required
                  onKeyPress="if(this.value.length==10) return false;">
                <mat-error>Mobile Number is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Select Billing Frequency*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Billing Frequency</mat-label> -->
                <mat-select formControlName="billing_frequency" required>
                  <mat-option *ngFor="let b of blng_frqncy_lst" [value]="b.frqncy_id">
                    {{b.frqncy_nm}}
                  </mat-option>
                </mat-select>
                <!-- <input matInput formControlName="billing_frequency" required> -->
                <mat-error>Billing Frequency is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">

            </div>

          </div>
          <mat-divider></mat-divider>
          <div class="font-size-17 font-weight-500 pt-8 mb-0 pl-8 pb-8 red-800-fg">Installation Details</div>
          <mat-divider style="margin-bottom: 13px;"></mat-divider>

          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Select Activation Date*</div>
              <mat-form-field appearance="outline">
                <input matInput [matDatepicker]="picker" formControlName="activationdate" required>
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
                <mat-error>Activation Date is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter House/Flat No*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>House/Flat No</mat-label> -->
                <input matInput formControlName="instl_house_flat_no" required>
                <mat-error> House/Flat No is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Building Name</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Building Name</mat-label> -->
                <input matInput formControlName="instl_buildingname">
                <!-- <mat-error>Building Name is required!</mat-error> -->
              </mat-form-field>
            </div>


          </div>

          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Street Name*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Street Name</mat-label> -->
                <input matInput formControlName="instl_streetname" required>
                <mat-error>Street Name is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Area/Locality Name*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Area/Locality Name</mat-label> -->
                <input matInput formControlName="instl_Area_Localityname" required>
                <mat-error>Area/Locality Name is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Pin Code*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Pin Code</mat-label> -->
                <input type="number" matInput formControlName="instl_pincode" required>
                <mat-error>Pin Code is required!</mat-error>
              </mat-form-field>
            </div>

          </div>
          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Select State Name*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>State</mat-label> -->
                <mat-select (selectionChange)="getDistricts()" formControlName="instl_state" required>
                  <mat-option *ngFor="let st of ste_lst" [value]="st.ste_id">
                    {{st.ste_nm}}
                  </mat-option>
                </mat-select>
                <mat-error>State is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Select District Name*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>District</mat-label> -->
                <mat-select (selectionChange)="getMandals([{id:1}])" formControlName="instl_district" required>
                  <mat-option *ngFor="let ds of dstrt_lst" [value]="ds.dstrt_id">
                    {{ds.dstrt_nm}}
                  </mat-option>
                </mat-select>
                <mat-error>District is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Select Mandal Name*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Mandal</mat-label>{{instl_mandal}} -->
                <mat-select (selectionChange)="getvillages([{id:1}])" formControlName="instl_mandal" required>
                  <mat-option *ngFor="let m of mndl_lst" [value]="m.mndl_id">
                    {{m.mndl_nm}}
                  </mat-option>
                </mat-select>
                <mat-error>Mandal is required!</mat-error>
              </mat-form-field>
            </div>



          </div>


          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Select City/Village Name*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>City/Village</mat-label> -->
                <mat-select formControlName="instl_city_villagename" required>
                  <mat-option *ngFor="let v of vlge_lst" [value]="v.vlge_id">
                    {{v.vlge_nm}}
                  </mat-option>
                </mat-select>
                <mat-error>City/Village is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Latitude</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Latitude</mat-label> -->
                <input matInput formControlName="instl_latitude">
                <!-- <mat-error>Last Name is required!</mat-error> -->
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Longitude</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Longitude</mat-label> -->
                <input matInput formControlName="instl_longitude">
                <!-- <mat-error>Mobile Number is required!</mat-error> -->
              </mat-form-field>
            </div>

          </div>

          <mat-divider></mat-divider>
          <div class="font-size-17 font-weight-500 pt-8 mb-0 pl-8 pb-8 red-800-fg">Billing Details</div>
          <mat-divider style="margin-bottom: 13px;"></mat-divider>
          <mat-checkbox formControlName="instl_chk_ind" (change)="checkValue(isChecked?'false':'true')">Same
            as Installation Address</mat-checkbox>

          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Contact Person Name*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Contact Person Name</mat-label> -->
                <input matInput formControlName="contactpersonname" required>
                <mat-error>Contact Person Name is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Contact Person Mobile Number*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Contact Person Mobile Number</mat-label> -->
                <input type="number" matInput formControlName="cntct_prsn_mobileNumber" required
                  onKeyPress="if(this.value.length==10) return false;">
                <mat-error>Mobile Number is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Contact Person Email*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Contact Person Email</mat-label> -->
                <input matInput formControlName="cntct_prsn_email">
                <!-- <mat-error>Last Name is required!</mat-error> -->
              </mat-form-field>
            </div>
          </div>

          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter House/Flat No*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>House/Flat No</mat-label> -->
                <input matInput formControlName="blng_house_flat_no" required>
                <mat-error> House/Flat No is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Building Name</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Building Name</mat-label> -->
                <input matInput formControlName="blng_buildingname">
                <!-- <mat-error>Building Name is required!</mat-error> -->
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Street Name*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Street Name</mat-label> -->
                <input matInput formControlName="blng_streetname" required>
                <mat-error>Street Name is required!</mat-error>
              </mat-form-field>
            </div>


          </div>
          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Area/Locality Name*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Area/Locality Name</mat-label> -->
                <input matInput formControlName="blng_Area_Localityname" required>
                <mat-error>Area/Locality Name is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Pin Code*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>Pin Code</mat-label> -->
                <input type="number" matInput formControlName="blng_pincode" required>
                <mat-error>Pin Code is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Select State Name*</div>
              <mat-form-field appearance="outline">
                <!-- <mat-label>State</mat-label> -->
                <mat-select (selectionChange)="getDistricts()" formControlName="blng_state" required>
                  <mat-option *ngFor="let st of ste_lst" [value]="st.ste_id">
                    {{st.ste_nm}}
                  </mat-option>
                </mat-select>
                <mat-error>State is required!</mat-error>
              </mat-form-field>
            </div>

          </div>


          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Select District Name*</div>
            <mat-form-field appearance="outline">
              <!-- <mat-label>District</mat-label> -->
              <mat-select (selectionChange)="getMandals([{id:2}])" formControlName="blng_district" required>
                <mat-option *ngFor="let ds of dstrt_lst" [value]="ds.dstrt_id">
                  {{ds.dstrt_nm}}
                </mat-option>
              </mat-select>
              <mat-error>District is required!</mat-error>
            </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Select Mandal Name*</div>
            <mat-form-field appearance="outline">
              <!-- <mat-label>Mandal</mat-label> -->
              <mat-select (selectionChange)="getvillages([{id:2}])" formControlName="blng_mandal" required>
                <mat-option *ngFor="let m of mndal_lst" [value]="m.mndl_id">
                  {{m.mndl_nm}}
                </mat-option>
              </mat-select>
              <mat-error>Mandal is required!</mat-error>
            </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Select City/Village Name*</div>
            <mat-form-field appearance="outline">
              <!-- <mat-label>City/Village</mat-label> -->
              <mat-select formControlName="blng_city_villagename" required>
                <mat-option *ngFor="let v of vilge_lst" [value]="v.vlge_id">
                  {{v.vlge_nm}}
                </mat-option>
              </mat-select>
              <mat-error>City/Village is required!</mat-error>
            </mat-form-field>
            </div>



          </div>
          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Latitude</div>
            <mat-form-field appearance="outline">
              <!-- <mat-label>Latitude</mat-label> -->
              <input matInput formControlName="blng_latitude">
              <!-- <mat-error>Last Name is required!</mat-error> -->
            </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">Enter Longitude</div>
            <mat-form-field appearance="outline">
              <!-- <mat-label>Longitude</mat-label> -->
              <input matInput formControlName="blng_longitude">
              <!-- <mat-error>Mobile Number is required!</mat-error> -->
            </mat-form-field>
            </div>

            <div fxFlex="50" fxFlex.xs="100" class="px-8">

            </div>


          </div>


          <!-- <div fxLayout="row" fxLayoutAlign="center center">
            <button mat-raised-button color="primary" class="m-2 saveBtn-color" (click)="saveCustomer()">Save</button>
            <button type="reset" mat-raised-button color="primary" class="m-2 resetBtn-color">Reset</button>
            
          </div> -->
          <!-- <mat-spinner  class="spnr-styl"></mat-spinner> -->


          <div class="m-0 p-16" fxLayout="row" fxLayoutAlign="end center">
            <div fxFlex fxFlex.gt-lg="50%" fxFlex.gt-md="50%" fxFlex.gt-sm="100%" fxFlex.gt-xs="100%"
              *ngIf="deleteCstmr" style="text-align: right;">
              <button mat-button class="mat-raised-button deleteBtn-color" aria-label="Delete" matTooltip="Delete"
                (click)="saveCustomer()">
                DELETE
              </button>
            </div>

            <div fxFlex fxFlex.gt-lg="50%" fxFlex.gt-md="50%" fxFlex.gt-sm="100%" fxFlex.gt-xs="100%"
              *ngIf="!deleteCstmr" style="text-align: right;">
              <button mat-flat-button type="submit" class="mat-raised-button saveBtn-color"
                [disabled]="firstFormGroup.invalid" aria-label="SAVE" (click)="saveCustomer()" style="width: 20%;">
                SAVE
              </button>
            </div>

            <div fxFlex fxFlex.gt-lg="50%" fxFlex.gt-md="50%" fxFlex.gt-sm="100%" fxFlex.gt-xs="100%">
              <button mat-flat-button type="submit" class="mat-raised-button  cnclBtn-color ml-8" aria-label="SAVE"
                (click)="opensideBar('addFormPanel',null)">
                CANCEL
              </button>
            </div>
          </div>
        </form>
      </div>
      <!-- </div> -->
    </ng-container>
  </ds-sidebar>

</div>