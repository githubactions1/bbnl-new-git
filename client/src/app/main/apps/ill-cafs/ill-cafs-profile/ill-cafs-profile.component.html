<div class="page-layout blank usrEmplye pageBackground cusAcntCmpnt">
  <div class="page-layout blank usrEmplye pageBackground cusAcntCmpnt">

    <div *ngIf="loader">
      <div class="loading-indicator">
        <div class="spinner-1">
          <img src="assets/images/logos/glits_D.png" style="max-width: 150%;">
        </div>
      </div>
    </div>
    <!-- <pg-top-header [headerDtls]="getHeaderDtls()"></pg-top-header> -->
    <div>
      <div class="text-right gridBtns">
        <mat-button-toggle-group class="topbtnClor mr-8 border-radius-5" appearance="legacy" name="fontStyle"
          aria-label="Font Style">
          <mat-button-toggle id="addGridBtn" *ngIf="(permissions.insrt_in==1)?true:false" >
            <mat-icon class="logo-icon mat-icon material-icons mat-icon-no-color">person_outline</mat-icon>
            Add Node
          </mat-button-toggle>
        </mat-button-toggle-group>
        <mat-button-toggle-group class="topbtnClor mr-8 border-radius-5" appearance="legacy" name="fontStyle"
          aria-label="Font Style">
          <mat-button-toggle id="addGridBtn" *ngIf="(permissions.insrt_in==1)?true:false" (click)="addNewCaf()">
            <mat-icon class="logo-icon mat-icon material-icons mat-icon-no-color">person_outline</mat-icon>
            Add CAF
          </mat-button-toggle>
        </mat-button-toggle-group>
        <mat-button-toggle-group class="topbtnClor mr-8 border-radius-5" appearance="legacy" name="fontStyle"
          aria-label="Font Style">
          <mat-button-toggle id="addGridBtn" *ngIf="(permissions.insrt_in==1)?true:false" (click)="saveBulkUpload()">
            <mat-icon class="logo-icon mat-icon material-icons mat-icon-no-color">person_outline</mat-icon>
            Bulk Upload
          </mat-button-toggle>
        </mat-button-toggle-group>
      </div>
      <div>
        <p class="ent-ttl mb-0">{{cafDtls.cstmr_nm}} </p>
        <div *ngIf="cafDtls.cstmr_nm" class="line-margin" style=" height: 9px;"><svg height="100" width="100">
            <line class="ng-tns-c32-251" style="fill:none;stroke:#53922c;stroke-miterlimit:10;stroke-width:1.5px"
              x1="2.15" x2="380.28" y1="3.09" y2="3.09"></line>
            <circle class="ng-tns-c32-251" cx="3.15" cy="3.15" r="3.15" style="fill:#53922c"></circle>
            <circle class="ng-tns-c32-251" cx="96.70" cy="3.15" r="3.15" style="fill:#53922c"></circle>
          </svg></div>
        <p class="ent-addrs">{{cafDtls.frst_nm}}</p>
        <p class="ent-addrs">Customer Type: {{cafDtls.entrpe_type_nm}}</p>
        <p class="ent-addrs">{{cafDtls.officeloc}}</p>
        <p class="ent-cntct"><span>{{cafDtls.mndl_nm}}&nbsp;Mandal</span> ,
          <span>{{cafDtls.dstrt_nm}}&nbsp;District</span></p>
        <p class="ent-cntct">
          <span><strong>
              <mat-icon class="transform-text">email</mat-icon>
            </strong>{{cafDtls.loc_eml1_tx}}</span> &nbsp;&nbsp;
          <span><strong>
              <mat-icon class="transform-text">phone</mat-icon>
            </strong>{{cafDtls.cntct_mble1_nu}}</span>
        </p>
      </div>
    </div>

    <div fxLayout="row wrap" fxLayoutAlign="start top">
      <div fxFlex="100" fxFlex.gt-xl="65%" fxFlex.gt-lg="65%" fxFlex.gt-md="50%" fxFlex.gt-sm="100%"
        fxFlex.gt-xs="100%">
        <div class="ds-card m-12" style="height: 509px;">
          <dx-data-grid class="p-8" id="gridContainer" [dataSource]="rowData" [remoteOperations]="false"
            [allowColumnReordering]="true" [allowColumnResizing]="true" [rowAlternationEnabled]="true"
            [showColumnLines]="true" [showRowLines]="true" [showBorders]="true" style="width:100%"
            (onCellClick)="onCellClick($event)" (onCellPrepared)="onCellPrepared(columnDefs,$event)">
            <dxo-export [enabled]="(permissions.exprt_in==1)?true:false" [allowExportSelectedData]="true">
            </dxo-export>
            <dxo-filter-row [visible]="true"></dxo-filter-row>
            <dxi-column *ngFor="let f of columnDefs" [visible]="!f.hide" [dataField]="f.field" [caption]="f.headerName"
              [alignment]="f.alignment" [width]="f.width"></dxi-column>
            <dxo-paging [pageSize]="10"></dxo-paging>
            <dxo-pager [visible]="true" [showPageSizeSelector]="true" [allowedPageSizes]="[10, 25, 50, 100]"
              [showInfo]="true"></dxo-pager>
            <dxo-search-panel [visible]="true" [highlightCaseSensitive]="true"></dxo-search-panel>
          </dx-data-grid>
        </div>
      </div>
      <div fxFlex="100" fxFlex.gt-xl="35%" fxFlex.gt-lg="35%" fxFlex.gt-md="50%" fxFlex.gt-sm="100%"
        fxFlex.gt-xs="100%">
        <div fxLayout="row wrap" fxLayoutAlign="start top" class="w-100-p m-8">
          <div class="ds-card today-card">
            <div fxLayout="row wrap" fxLayoutAlign="start top" class="card-height">
              <div fxFlex="100" fxFlex.gt-xl="15%" fxFlex.gt-lg="15%" fxFlex.gt-md="15%" fxFlex.gt-sm="15%"
                fxFlex.gt-xs="15%" class="bg-c-blue border-today-card">
                <mat-icon>supervisor_account</mat-icon>
                <div>CAFs</div>
              </div>
              <div fxFlex="100" fxFlex.gt-xl="30%" fxFlex.gt-lg="15%" fxFlex.gt-md="15%" fxFlex.gt-sm="15%"
                fxFlex.gt-xs="15%" class="text-center p-24 mt-24">
                <h2 class="h1 cnt">{{cafcount == undefined ? 0 : cafcount.tot_cafs}}</h2>
                <div class="h4 nme">Total <br> CAFs</div>
              </div>
              <div fxFlex="100" fxFlex.gt-xl="30%" fxFlex.gt-lg="15%" fxFlex.gt-md="15%" fxFlex.gt-sm="15%"
                fxFlex.gt-xs="15%" class="text-center p-24 mt-24">
                <h2 class="h1 cnt">{{nodcount == undefined ? 0 : nodcount.count}}</h2>
                <div class="h4 nme">Total <br> Nodes</div>
              </div>
              <div fxFlex="100" fxFlex.gt-xl="30%" fxFlex.gt-lg="15%" fxFlex.gt-md="15%" fxFlex.gt-sm="15%"
                fxFlex.gt-xs="15%" class="text-center p-24 mt-24">
                <h2 class="h1 cnt">{{cafcount == undefined ? 0 : cafcount.tot_actv_cafs}}</h2>
                <div class="h4 nme">Total <br> Active</div>
              </div>
              <div fxFlex="100" fxFlex.gt-xl="30%" fxFlex.gt-lg="18%" fxFlex.gt-md="18%" fxFlex.gt-sm="18%"
                fxFlex.gt-xs="18%" class="text-center p-24 mt-24">
                <h2 class="h1 cnt">{{cafcount == undefined ? 0 : cafcount.tot_spnd_cafs}}</h2>
                <div class="h4 nme">Total <br> Suspended</div>
              </div>
              <div fxFlex="100" fxFlex.gt-xl="30%" fxFlex.gt-lg="18%" fxFlex.gt-md="18%" fxFlex.gt-sm="18%"
                fxFlex.gt-xs="18%" class="text-center p-24 mt-24">
                <h2 class="h1 cnt">{{cafcount == undefined ? 0 : cafcount.tot_trmnd_cafs}}</h2>
                <div class="h4 nme">Total <br> Terminated</div>
              </div>
            </div>
          </div>
        </div>

        <div fxLayout.xl="row" fxLayout.lg="row" fxLayout.md="row" fxLayout.sm="row wrap" fxLayout.xs="column"
          class="w-100-p m-8">
          <div fxFlex="100" fxFlex.gt-xl="50%" fxFlex.gt-lg="50%" fxFlex.gt-md="33%" fxFlex.gt-sm="33%"
            fxFlex.gt-xs="50%">
            <div class="ds-card dsbbrdcrds widget-statstic-card">
              <div class="card-block">
                <div class="icofont icofont-presentation-alt st-icon bg-icon-violet">
                  <mat-icon>group_add</mat-icon>
                </div>
                <div fxLayout="row wrap" fxLayoutAlign="start top" fxLayoutAlign="start top" class="p-16">
                  <div fxFlex="100" fxFlex.gt-xl="100%" fxFlex.gt-lg="100%" fxFlex.gt-md="100%" fxFlex.gt-sm="100%"
                    fxFlex.gt-xs="50%" class="text-center ">
                    <div class="h1 cnt">
                      {{crntMnthCnts == undefined || crntMnthCnts.crnt_mnth_prvd == null ? 0 : crntMnthCnts.crnt_mnth_prvd}}
                    </div>
                  </div>
                </div>
                <div class="text-center font-weight-500 fg-icon-violet">
                  <div>CAFs Provisioned <div class="font-size-12 font-weight-400">This Month</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div fxFlex="100" fxFlex.gt-xl="50%" fxFlex.gt-lg="50%" fxFlex.gt-md="33%" fxFlex.gt-sm="33%"
            fxFlex.gt-xs="50%">
            <div class="ds-card dsbbrdcrds widget-statstic-card">
              <div class="card-block">
                <div class="icofont icofont-presentation-alt st-icon bg-icon-blue-light">
                  <mat-icon>priority_high</mat-icon>
                </div>
                <div fxLayout="row wrap" fxLayoutAlign="start top" fxLayoutAlign="start top" class="p-16">
                  <div fxFlex="100" fxFlex.gt-xl="100%" fxFlex.gt-lg="100%" fxFlex.gt-md="100%" fxFlex.gt-sm="100%"
                    fxFlex.gt-xs="100%" class="text-center ">
                    <div class="h1 cnt">
                      {{crntMnthCnts == undefined || crntMnthCnts.crnt_mnth_spnd_cafs == null ? 0 : crntMnthCnts.crnt_mnth_spnd_cafs}}
                    </div>
                  </div>
                </div>
                <div class="text-center font-weight-500 fg-icon-blue-light">
                  <div>CAFs Suspended <div class="font-size-12 font-weight-400">This Month</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div fxFlex="100" fxFlex.gt-xl="50%" fxFlex.gt-lg="50%" fxFlex.gt-md="33%" fxFlex.gt-sm="33%"
            fxFlex.gt-xs="50%">
            <div class="ds-card dsbbrdcrds widget-statstic-card">
              <div class="card-block">
                <div class="icofont icofont-presentation-alt st-icon bg-icon-pink">
                  <mat-icon>format_size</mat-icon>
                </div>
                <div fxLayout="row wrap" fxLayoutAlign="start top" fxLayoutAlign="start top" class="p-16">
                  <div fxFlex="100" fxFlex.gt-xl="100%" fxFlex.gt-lg="100%" fxFlex.gt-md="100%" fxFlex.gt-sm="100%"
                    fxFlex.gt-xs="100%" class="text-center ">
                    <div class="h1 cnt">
                      {{crntMnthCnts == undefined || crntMnthCnts.crnt_mnth_trmnd_cafs == null ? 0 : crntMnthCnts.crnt_mnth_trmnd_cafs}}
                    </div>
                  </div>
                </div>
                <div class="text-center font-weight-500 fg-icon-pink">
                  <div>CAFs Terminated <div class="font-size-12 font-weight-400">This Month</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div fxLayout="row wrap" fxLayoutAlign="start top" class="w-100-p m-8">
          <div class="ds-card today-card">
            <div fxLayout="row wrap" fxLayoutAlign="start top" class="card-height">
              <div fxFlex="100" fxFlex.gt-xl="15%" fxFlex.gt-lg="15%" fxFlex.gt-md="15%" fxFlex.gt-sm="15%"
                fxFlex.gt-xs="15%" class="bg-c-pink border-today-card">
                <mat-icon>how_to_reg</mat-icon>
                <div>CAFs Provisioned</div>
              </div>
              <div fxFlex="100" fxFlex.gt-xl="30%" fxFlex.gt-lg="15%" fxFlex.gt-md="15%" fxFlex.gt-sm="15%"
                fxFlex.gt-xs="15%" class="text-center p-24 mt-24" *ngFor="let p of allPrvMnthCnts">
                <h2 class="h1 cnt">{{allPrvMnthCnts == undefined ? 0 : p.mnth_prvd}}</h2>
                <div class="h4 nme">{{p.mnth}} {{p.yr}}</div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
    <!-- sidebar -->
    <ds-sidebar class="form-panel ds-form-sidebar" name="addFormPanel" position="right" [invisibleOverlay]="false">
      <ng-container>
        <div fxLayout="column">
          <div class="card">
            <div class="card-body" *ngIf="cstmrData">
              <mat-icon matTooltip="close" (click)="closeSideBar()" class="closeSidebar closeSidebarPrfle"
                style="float:right">cancel </mat-icon>
              <ds-customer-profile [cstmrData]="cstmrData"></ds-customer-profile>
            </div>
          </div>
        </div>
      </ng-container>
    </ds-sidebar>
    <!-- sidebar -->