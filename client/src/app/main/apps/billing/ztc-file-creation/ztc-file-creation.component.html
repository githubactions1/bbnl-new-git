<div class="page-layout simple tabbed pageBackground cstmrprtcmpnt">
  <pg-top-header [headerDtls]="getHeaderDtls()"></pg-top-header>
  <div class="ds-card m-12 p-12 text-center noPermsMsgColor" *ngIf="!permissions">{{shwPermMsg}}</div>
  <div class="ds-card m-12" *ngIf="permissions">
    <div fxLayout="row" fxLayout.xs="column">
      <div fxFlex="40" fxFlex.xs="100" class="px-8">
        <form class=" p-8" fxLayout="row" [formGroup]='ZtcForm'>
          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">From Date<span class="reqSgnColor">*</span></div>
              <mat-form-field appearance="outline">
                <input matInput [matDatepicker]="picker" placeholder="From Date" formControlName="Frmdt">
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
                <mat-error>From Date is required!</mat-error>
              </mat-form-field>
            </div>
            <div fxFlex="50" fxFlex.xs="100" class="px-8">
              <div class="form-label">To Date<span class="reqSgnColor">*</span></div>
              <mat-form-field appearance="outline">
                <input matInput [matDatepicker]="pickerTo" placeholder="To Date" formControlName="Todt">
                <mat-datepicker-toggle matSuffix [for]="pickerTo"></mat-datepicker-toggle>
                <mat-datepicker #pickerTo></mat-datepicker>
                <mat-error>To Date is required!</mat-error>
              </mat-form-field>
            </div>
          </div>
        </form>
      </div>
      <div fxFlex="2" fxFlex.xs="100" class="px-8">
        <p class="pclsred">(OR)</p>
      </div>
      <div fxFlex="20" fxFlex.xs="100" class="px-8">
        <form class=" p-8" fxLayout="column" [formGroup]='ZtcForm1'>
          <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
            <div fxFlex="100" fxFlex.gt-lg="100%" fxFlex.gt-md="100%" fxFlex.gt-sm="100%" fxFlex.gt-xs="100%"
              fxFlex.xs="100" class="px-8" fxLayout="column" fxLayoutAlign="start start">
              <div class="form-label">CAF Code</div>
              <mat-form-field appearance="outline" fxFlex>
                <!-- <input matInput placeholder="Search" aria-label="State" [matAutocomplete]="auto"
                  formControlName="caf_id">
                <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
                  <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                  <ng-container *ngIf="!isLoading">
                    <mat-option *ngFor="let caf of filteredcafs;trackBy:trackByfunction" [value]="caf">
                      <span><b>{{caf.cstmr_nm}}</b></span>
                    </mat-option>
                  </ng-container>
                </mat-autocomplete> -->
                  <input name="name" type="number" formControlName="caf_id" matInput required/>
                <mat-error>Caf is required!</mat-error>
              </mat-form-field>
            </div>
          </div>
        </form>

      </div>
      <!-- <div fxFlex="2" fxFlex.xs="100" class="px-8">
        <p class="pclsred">(OR)</p>
      </div> -->
      <!-- <div fxFlex="20" fxFlex.xs="100" class="px-8"> -->
        <!-- <form class=" p-8" fxLayout="column" [formGroup]='ZtcForm2'>
          <div fxFlex="100" fxFlex.gt-lg="60%" fxFlex.gt-md="60%" fxFlex.gt-sm="60%" fxFlex.gt-xs="60%" class="px-8"
           >
            <div class="form-label">Upload Excel file</div>
            <input type="file" id="file" formControlName="Upd_excl" required>
            <label for="file">choose a file</label>
          </div>
          <div fxFlex="100" fxFlex.gt-lg="40%" fxFlex.gt-md="40%" fxFlex.gt-sm="40%" fxFlex.gt-xs="40%" >
            <div class="mt-40 pl-4">
              <span class='ttlRcds'>Total Records()</span>
              <span class='vldecxl'  style="color: red;">&nbsp;Please Upload Valid
                Excel</span>
              <span class='vldecxl'  style="color: red;">&nbsp;</span>
            </div>
          </div>
        </form> -->

      <!-- </div> -->
      <div fxFlex="15" fxFlex.xs="100" class="px-8 gtDtlsBtn" *ngIf="permissions">
        <button type="submit" mat-raised-button color="primary" *ngIf="permissions.insrt_in==1"
          [disabled]="ZtcForm.invalid && ZtcForm1.invalid && ZtcForm2.invalid" (click)="submit()" class="gtDtls">Generate ZTC</button>
          <p class="errm" *ngIf="errMssge">Please select one value only</p>
      </div>
    </div>
  </div>

  <ds-loading *ngIf="showLdr"></ds-loading>

  <div class="ds-card m-12" style="margin-top:1%" *ngIf="permissions">
    <div fxLayout="row" fxLayout.xs="column" fxFlexFill>
      <div fxFlex.xs="100" class="px-8" fxLayout="column" fxLayoutAlign="start start">
        <dx-data-grid id="gridContainer" [dataSource]="Filedtls" [showBorders]="true" [remoteOperations]="true" [columnAutoWidth]="true"
          [allowColumnReordering]="true" [rowAlternationEnabled]="true" [showColumnLines]="true" [showRowLines]="true"
          [showBorders]="true" style="width:100%" (onCellPrepared)="onCellPrepared(null,$event)"
          (onCellClick)="onCellClick($event)">
          <dxi-column caption="DSN File Count" dataField="dsn_cnt">
          </dxi-column>
          <dxi-column caption="DSN File Path" dataField="dsn_path" cellTemplate="dsnTemplate">
          </dxi-column>
          <dxi-column caption="ZTE File Count" dataField="zte_cnt">
          </dxi-column>
          <dxi-column caption="ZTE File Path" dataField="zte_path" cellTemplate="ztcTemplate">
          </dxi-column>
          <div *dxTemplate="let data of 'dsnTemplate'">
            <a href='http://localhost:4901/apiv1/dsn/{{data.row.data.path}}/{{data.row.data.filnm}}'>{{data.value}}</a>
          </div>
          <div *dxTemplate="let data of 'ztcTemplate'">
            <a href='http://localhost:4901/apiv1/zte/{{data.row.data.path}}/{{data.row.data.filnm}}' download>{{data.value}}</a>
          </div>
       
          <dxo-paging [pageSize]="10"></dxo-paging>
          <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[10, 12, 20]"></dxo-pager>
          <dxo-search-panel [visible]="true" [highlightCaseSensitive]="true"></dxo-search-panel>
          <dxo-filter-panel [visible]="true"></dxo-filter-panel>
          <dxo-group-panel [visible]="true"></dxo-group-panel>
          <dxo-grouping [autoExpandAll]="false"></dxo-grouping>
          <dxo-column-chooser [enabled]="true" mode="select">
            <!-- or "select" -->
          </dxo-column-chooser>
        </dx-data-grid>
      </div>
    </div>
  </div>
</div>