<div class="page-layout simple pageBackground">
  <pg-top-header [headerDtls]="getHeaderDtls()"></pg-top-header>
  <ds-loading *ngIf="loader == true"></ds-loading>
  <div class="row fltrcrd p-4 m-8">
    <div fxFlex="100" fxFlex.gt-lg="17%" fxFlex.gt-md="17%" fxFlex.gt-sm="17%" fxFlex.gt-xs="17%" class="px-8">
      <div class="form-label">Select Year</div>
      <mat-form-field appearance="outline">
        <mat-select [(ngModel)]="slctdyear" matInput required>
          <mat-option *ngFor="let yr of year" [value]="yr.yr_id">
            {{yr.yr_nm}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div fxFlex="17" fxFlex.xs="100" class="px-8 gtDtlsBtn">
      <button mat-raised-button color="primary" (click)="getdetails();" class="gtDtls">GET DETAILS</button>
    </div>
  </div>
  
  <div class="ds-card m-12">
        <dx-data-grid class="p-8" id="gridContainer" [dataSource]="monThWiseData" [remoteOperations]="false"
            [allowColumnReordering]="true"  [rowAlternationEnabled]="true" [showColumnLines]="true"
            [showRowLines]="true" [showBorders]="true" 
            (onRowExpanding)="onRowExpanding($event)"
            [masterDetail]="{ enabled: true, template: 'detail' }" style="width: 100%;">
            <!-- <dxo-selection mode="multiple"></dxo-selection> -->
            <dxo-paging [pageSize]="10"></dxo-paging>
            <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[10, 25, 50, 100]" [showInfo]="true"></dxo-pager>
            <dxo-search-panel [visible]="true" [highlightCaseSensitive]="true"></dxo-search-panel>
            <dxo-filter-panel [visible]="true"></dxo-filter-panel>
            <dxo-group-panel [visible]="true"></dxo-group-panel>
            <dxo-grouping [autoExpandAll]="false"></dxo-grouping>
            <dxo-column-chooser [enabled]="true" mode="select">
            </dxo-column-chooser>
            <dxo-export [enabled]="(permissions.exprt_in==1)?true:false" [allowExportSelectedData]="true" fileName="Revenue Sharing">
            </dxo-export>
            <dxo-filter-row [visible]="true"></dxo-filter-row>
            <dxi-column [allowResizing]="true" *ngFor="let g of gridColumnDefs" [visible]="!g.hide" [dataField]="g.field"
                [caption]="g.headerName" [alignment]="g.algnmnt" [width]="g.width" [allowFiltering]="g.filter" [allowHeaderFiltering]="g.filter"
                [format]="(g.format == true) ? {type:g.type,currency:g.currency, precision:g.precision}: false"></dxi-column>
                <div *dxTemplate="let agrmtData of 'detail'">
                  <dx-data-grid [dataSource]="custmerWiseData" [showBorders]="true" [allowColumnResizing]="true"
                      [columnAutoWidth]="true"  [rowAlternationEnabled]="true" [showColumnLines]="true" (onRowExpanding)="onRowExpandingtwo($event)"  
                      [masterDetail]="{ enabled: true, template: 'details' }">
                      <dxo-paging [pageSize]="10"></dxo-paging>
                      <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[10, 25, 50, 100]" [showInfo]="true"></dxo-pager>
                      <dxo-search-panel [visible]="true" [highlightCaseSensitive]="true"></dxo-search-panel>
                      <!-- <dxo-filter-panel [visible]="true"></dxo-filter-panel>
                      <dxo-group-panel [visible]="true"></dxo-group-panel>
                      <dxo-grouping [autoExpandAll]="false"></dxo-grouping> -->
                      <dxo-column-chooser [enabled]="true" mode="select">
                      </dxo-column-chooser>
                      <dxo-export [enabled]="(permissions.exprt_in==1)?true:false" [allowExportSelectedData]="true">
                      </dxo-export>
                      <dxi-column [allowResizing]="true" dataField="Sno" alignment="center" [width]="60"></dxi-column>
                      <dxi-column [allowResizing]="true" dataField="CAF Invoice Id" alignment="center" [width]="140"></dxi-column>
                      <dxi-column [allowResizing]="true" caption="Invoice Year" dataField="Invoice Year" alignment="center" [width]="130"> </dxi-column>
                      <dxi-column [allowResizing]="true" caption="Invoice Month" dataField="Invoice Month" alignment="center" [width]="130"></dxi-column>
                      <dxi-column [allowResizing]="true" caption="CAF Number" dataField="CAF Number" alignment="center" [width]="130"></dxi-column>
                      <dxi-column [allowResizing]="true" caption="CAF Activation Date" dataField="Activation Date" alignment="center" [width]="130"></dxi-column>
                      <dxi-column [allowResizing]="true" dataField="Customer Name" alignment="left" [width]="150"></dxi-column>
                      <dxi-column [allowResizing]="true" dataField="Customer Mobile No" alignment="center" [width]="150"></dxi-column>
                      <dxi-column [allowResizing]="true" dataField="APSFL Share"  alignment="right" [width]="150"></dxi-column>
                      <dxi-column [allowResizing]="true" dataField="MSO Share" alignment="right" [width]="150"></dxi-column>
                      <dxi-column [allowResizing]="true" dataField="LMO Share" alignment="right" [width]="150"></dxi-column>
					  <dxi-column [allowResizing]="true" dataField="ActiveDays" alignment="right" [width]="150"></dxi-column>
					  <dxi-column [allowResizing]="true" dataField="Suspend Date" alignment="right" [width]="150"></dxi-column>
                      <dxi-column [allowResizing]="true" dataField="Termination Date" alignment="right" [width]="150"></dxi-column>
                      <dxi-column [allowResizing]="true" dataField="Invoice Amount" alignment="right" [width]="150"></dxi-column>
                      <dxi-column [allowResizing]="true" dataField="Status" alignment="center" [width]="150"></dxi-column>
                      <div *dxTemplate="let agrmtData of 'details'">
                        <dx-data-grid [allowColumnResizing]="true"  [dataSource]="custmerWisedetailsData" [showBorders]="true"
                            [columnAutoWidth]="true" [rowAlternationEnabled]="true" [showColumnLines]="true">
                            <dxo-paging [pageSize]="10"></dxo-paging>
                            <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[10, 25, 50, 100]" [showInfo]="true"></dxo-pager>
                            <dxi-column [allowResizing]="true" dataField="Sno"></dxi-column>
                            <dxi-column [allowResizing]="true" dataField="Package name"></dxi-column>
                            <dxi-column [allowResizing]="true" dataField="Package Type"></dxi-column>
                            <dxi-column [allowResizing]="true" dataField="Charge Description Text"></dxi-column>
                            <dxi-column [allowResizing]="true" dataField="Charge Code" ></dxi-column>
                            <dxi-column [allowResizing]="true" dataField="Charge Amount"></dxi-column>
                            <dxi-column [allowResizing]="true" dataField="Tax Amount"></dxi-column>
                            <dxi-column [allowResizing]="true" dataField="Total Amount"></dxi-column>
                            <!-- <dxi-column [allowResizing]="true" dataField="Sno" alignment="center"></dxi-column>
                            <dxi-column [allowResizing]="true" dataField="Package Name" alignment="center"></dxi-column>
                            <dxi-column [allowResizing]="true" dataField="Charge Code" alignment="center"></dxi-column>
                            <dxi-column [allowResizing]="true" dataField="Charge Code Description" alignment="center"></dxi-column>
                            <dxi-column [allowResizing]="true" dataField="APSFL Share" alignment="right"></dxi-column>
                            <dxi-column [allowResizing]="true"dataField="MSO Share" alignment="right"></dxi-column>
                            <dxi-column [allowResizing]="true" dataField="LMO Share" alignment="right"></dxi-column>
                            <dxi-column [allowResizing]="true"dataField="Total" alignment="right"></dxi-column>
                            <dxi-column [allowResizing]="true"dataField="Charge From Date" alignment="center"></dxi-column>
                            <dxi-column [allowResizing]="true"dataField="Charge To Date" alignment="center"></dxi-column>
                            <dxi-column [allowResizing]="true"dataField="Pro rated" alignment="center"></dxi-column> -->
                        </dx-data-grid>
                    </div>
                  </dx-data-grid>
              </div>
        </dx-data-grid>
</div>
</div>